// Test diag
assert_eq(diag([[1, 2, 3], [4, 5, 6], [7, 8, 9]]), [1, 5, 9]);
assert_eq(diag([1, 2, 3]), [[1.0, 0.0, 0.0], [0.0, 2.0, 0.0], [0.0, 0.0, 3.0]]);